#####################################################################
# 	Comments
#####################################################################
# This file contains common pin mappings for the BIGTREETECH Manta M8P V1.1
# To use this config, the firmware should be compiled for the
# STM32G0B1 with a "8KiB bootloader" and USB communication.

# See docs/Config_Reference.md for a description of parameters.


#####################################################################
# 	Includes
#####################################################################
[include mainsail.cfg]
[include KAMP_Settings.cfg]

# Add MCU Config
[include machineconf/mcus.cfg]

# Add Config for Motion Stepper Motor (x,y,z,z1)
[include machineconf/motionstepper.cfg]

# Add Config for Heated Bed
[include machineconf/BedSet.cfg]

# Add Config for Microprobe
[include machineconf/Microprobe.cfg]

# Add Config for LEDs
[include machineconf/LEDSet.cfg]

# Add Config for LCD
[include machineconf/LCDSet.cfg]

# Add Config for Accelerometer
[include machineconf/accel.cfg]

# Add Config for Filament Runout 
[include machineconf/filaSensors.cfg]

# ToolChanger Config
[include BTC_Klipper/btc.cfg]

# Custom Gcodes
[include CustomCode/mygcodes.cfg]
[include  CustomCode/TEST_SPEED.cfg]

[exclude_object]

[save_variables]
filename: ~/printer_saved_variables.cfg

#####################################################################
# 	printer settings
#####################################################################
[virtual_sdcard]
path: ~/printer_data/gcodes
on_error_gcode: CANCEL_PRINT

[printer]
kinematics: corexy
max_velocity: 600
max_accel: 30000
max_z_velocity: 25
max_z_accel: 30
minimum_cruise_ratio: 0.3

[heater_bed]
#control: pid
#pid_Kp: 75.183
#pid_Ki: 0.751
#pid_Kd: 1880.506

[probe]
#z_offset: 0.0

[bed_mesh]
speed: 300
probe_count: 10,10 #20,20 #40, 40
horizontal_move_z: 5
mesh_min : 20, 20
mesh_max : 340, 280
algorithm: bicubic


#####################################################################
# 	Fan Settings
#####################################################################
# Fan4: Part cooling Fan
[fan]
pin: PE4 

#####################################################################
# 	Input Shaping
#####################################################################
[input_shaper]
#shaper_type_x = 3hump_ei
#shaper_freq_x = 49.0
#shaper_type_y = ei
#shaper_freq_y = 112.8


#####################################################################
# 	Compensations
#####################################################################
[axis_twist_compensation]
speed: 100
horizontal_move_z: 5
calibrate_start_x: 60
calibrate_end_x: 340
calibrate_y: 138
# For Y-axis twist compensation, specify the following parameters:
calibrate_start_y: 41
calibrate_end_y: 260
calibrate_x: 200

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [probe]
#*# z_offset = 0.550
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 76.385
#*# pid_ki = 0.780
#*# pid_kd = 1870.484
#*#
#*# [axis_twist_compensation]
#*# z_compensations = 0.030000, -0.025000, -0.005000
#*# compensation_start_x = 60.0
#*# compensation_end_x = 340.0
#*# zy_compensations = 0.064167, -0.004583, -0.059583
#*# compensation_start_y = 41.0
#*# compensation_end_y = 260.0
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  0.006250, 0.006250, -0.012500, -0.038750, -0.062500
#*# 	  -0.005000, 0.002500, -0.032500, -0.040000, -0.070000
#*# 	  0.013750, -0.012500, 0.001250, -0.021250, -0.043750
#*# 	  -0.022500, -0.015000, -0.031250, -0.048750, -0.068750
#*# 	  -0.008750, -0.033750, -0.047500, -0.071250, -0.070000
#*# 	  -0.035000, -0.057500, -0.078750, -0.073750, -0.071250
#*# x_count = 5
#*# y_count = 6
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = lagrange
#*# tension = 0.2
#*# min_x = 134.0
#*# max_x = 266.0
#*# min_y = 94.0
#*# max_y = 226.00000000000003
